import{normalizePath as r}from"vite";const t=r=>r.replace(/^.*[\\\/]/,""),n=(r,t)=>`import ${r} from '${t}'`,e=(r,t)=>`const ${r} = lazy(() => import('${t}'))`,o=new Map;function a(r){const c=new Set,i=new Set,s=new Array,u=(r,t=!1)=>{void 0!==o.get(r)&&t||o.set(r,t)},l=(r,n="")=>{for(const[e,o]of Object.entries(r)){const r=`${n}${e}`;if("object"==typeof o)if(o.src){const n=o,e=n.src,l=n.dynamic??!1;u(e,l);const m={};if(n.action&&(m.action=n.action),n.errorElement&&(m.errorElement=n.errorElement),n.hasErrorBoundary&&(m.hasErrorBoundary=n.hasErrorBoundary),n.loader&&(m.loader=n.loader),n.shouldRevalidate&&(m.shouldRevalidate=n.shouldRevalidate),n.children){const r=a(n.children);r.imports.dynamic.forEach((r=>{c.add(r)})),r.imports.static.forEach((r=>{i.add(r)})),m.children=`${r.routes}`}s.push({route:r,component:t(e),config:m})}else l(o,r);else u(o),s.push({route:r,component:t(o)})}};return l(r),{imports:(()=>{for(const[r,a]of o){const o=t(r);a?c.add(e(o,r)):i.add(n(o,r))}return{dynamic:Array.from(c)??[],static:Array.from(i)??[]}})(),routes:s.map((({route:r,component:t,config:n})=>`\n        {\n          path: '${r}',\n          element: /*#__PURE__*/React.createElement(${t}, null),\n          ${(r=>{const t="async";return Object.entries(r).map((([r,n])=>{if("function"==typeof n){let e=n.toString();return e.startsWith(t)&&(e=e.slice(t.length,e.length).trim()),e.startsWith("function")?`${r}: ${n.toString()}`:`${n.toString()}`}return"children"===r?`${r}: [\n            ${n}\n          ],`:`${r}: ${n},`})).join("\n")})(n??{})}\n        }\n      `))}}function c(t){const{name:n,option:e,root:c}=t,i=`${c??""}/${r(n??"router.config.js")}`;return{name:"vite-plugin-react-router-dom",enforce:"pre",async load(r){if(r.includes(i)){return function(r,t={}){o.clear();const{imports:n,routes:e}=a(r);return`\n  import React from 'react';\n  import { createBrowserRouter } from 'react-router-dom';\n  import { lazy } from 'react';\n\n  ${n.static.join("\n")}\n  ${n.dynamic.join("\n")}\n  \n  const router = createBrowserRouter(\n    [${e}],\n    ${JSON.stringify(t)}\n  );\n  \n  export default router;\n  `}((await import(r)).default,e)}return null}}}export{c as default};
//# sourceMappingURL=vite-plugin-react-router-dom.js.map
