import{normalizePath as t}from"vite";const r=t=>t.replace(/^.*[\\\/]/,""),n=(t,r)=>`import ${t} from '${r}'`,o=(t,r)=>`const ${t} = lazy(() => import('${r}'))`,e=new Map;function a(t){const c=new Set,i=new Set,s=new Array,m=(t,r=!1)=>{void 0!==e.get(t)&&r||e.set(t,r)},l=(t,n="")=>{for(const[o,e]of Object.entries(t)){const t=`${n}${o}`;if("object"==typeof e)if(e.src){const n=e,o=n.src,l=n.dynamic??!1;m(o,l);const u={};if(n.action&&(u.action=n.action),n.errorElement&&(u.errorElement=n.errorElement),n.hasErrorBoundary&&(u.hasErrorBoundary=n.hasErrorBoundary),n.loader&&(u.loader=n.loader),n.shouldRevalidate&&(u.shouldRevalidate=n.shouldRevalidate),n.dynamic&&(u.lazy=`async () => {\n              const imports = await import('${n.src}')\n              const component = imports.default ?? imports.Component;\n              const loader = imports.loader ? { loader: imports.loader } : {};\n              return {\n                Component: component,\n                ...loader,\n              }\n            }`),n.children){const t=a(n.children);t.imports.dynamic.forEach((t=>{c.add(t)})),t.imports.static.forEach((t=>{i.add(t)})),u.children=`${t.routes}`}s.push({route:t,component:r(o),config:u})}else l(e,t);else m(e),s.push({route:t,component:r(e)})}};return l(t),{imports:(()=>{for(const[t,a]of e){const e=r(t);a?c.add(o(e,t)):i.add(n(e,t))}return{dynamic:Array.from(c)??[],static:Array.from(i)??[]}})(),routes:s.map((({route:t,component:r,config:n})=>{const o=n??{};return`\n        {\n          path: '${t}',\n          ${o.lazy?"":`element: /*#__PURE__*/React.createElement(${r}, null),`}\n          ${(t=>{const r="async";return Object.entries(t).map((([t,n])=>{if("function"==typeof n){let o=n.toString();return o.startsWith(r)&&(o=o.slice(r.length,o.length).trim()),o.startsWith("function")?`${t}: ${n.toString()},`:`${n.toString()},`}return"children"===t?`${t}: [\n            ${n}\n          ],`:`${t}: ${n},`})).join("\n")})(o)}\n        }\n      `}))}}function c(r){const{name:n,option:o,root:c}=r,i=`${c??""}/${t(n??"router.config.js")}`;return{name:"vite-plugin-react-router-dom",enforce:"pre",async load(t){if(t.includes(i)){return function(t,r={}){e.clear();const{imports:n,routes:o}=a(t);return`\n  import React from 'react';\n  import { createBrowserRouter } from 'react-router-dom';\n  import { lazy } from 'react';\n\n  ${n.static.join("\n")}\n  \n  const router = createBrowserRouter(\n    [${o}],\n    ${JSON.stringify(r)}\n  );\n  \n  export default router;\n  `}((await import(t)).default,o)}return null}}}export{c as default};
//# sourceMappingURL=vite-plugin-react-router-dom.js.map
